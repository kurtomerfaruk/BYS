<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:ui="jakarta.faces.facelets"
      xmlns:pe="primefaces.extensions"
      xmlns:p="primefaces">
<ui:composition>

    <p:panelGrid columns="1" class="w-100" id="dosyaPanel" rendered="#{eyKisiController.selected !=null}" layout="tabular">

        <p:fileUpload id="upload"
                      mode="advanced"
                      dragDropSupport="false"
                      cancelLabel="#{messages.buttonIptal}"
                      uploadLabel="#{messages.buttonYukle}"
                      label="#{messages.buttonSec}"
                      invalidFileMessage="#{messages.hataliDosyaTipi}"
                      invalidSizeMessage="#{messages.hataliDosyaBoyutu}"
                      listener="#{eyKisiDosyaController.handleFileUpload}"
                      multiple="false"
                      update=":growl,dosyaID"
                      fileLimit="5"
                      allowTypes="/(\.|\/)(gif|jpe?g|png|jpg|pdf|xls|xlsx|doc|docx)$/">
            <p:validateFile sizeLimit="10000000"/>
        </p:fileUpload>

        <p:dataTable id="dosyaID"
                     value="#{eyKisiController.selected.eyKisiDosyaList}"
                     var="dosyaItem"
                     style="width: auto"
                     emptyMessage="#{messages.kayitBulunamadi}"
                     paginator="true"
                     rows="5"
                     paginatorPosition="bottom">

            <p:column>
                #{dosyaItem.dosyaAdi}
            </p:column>

            <p:column width="60" headerText="#{messages.buttonIndir}">
                <p:commandButton icon="pi pi-download"
                                 title="#{messages.buttonIndir}"
                                 actionListener="#{eyKisiDosyaController.setSelectedDosya(dosyaItem)}"
                                 ajax="false"
                                 update="dosyaID">
                    <p:fileDownload value="#{eyKisiDosyaController.download}"/>
                </p:commandButton>
            </p:column>

            <p:column width="60" headerText="#{messages.buttonOnizle}">
                <p:commandButton icon="pi pi-search"
                                 title="#{messages.buttonOnizle}"
                                 actionListener="#{imageController.getKisiDosyaImage(dosyaItem)}"
                                 update="EyKisiEditForm:formResim,:growl"
                                 rendered="#{eyKisiController.resimMi(dosyaItem)}"
                                 oncomplete="PF('dialogResim').show()">
                </p:commandButton>
            </p:column>

            <p:column width="60" headerText="#{messages.buttonSil}">
                <p:commandButton icon="pi pi-trash"
                                 title="#{messages.buttonSil}"
                                 actionListener="#{eyKisiDosyaController.dosyaSil(dosyaItem)}"
                                 update="dosyaID,:growl"
                                 process="dosyaID"/>
            </p:column>

        </p:dataTable>

    </p:panelGrid>

    <p:dialog id="dlgResim" header="Dosya Detayı" widgetVar="dialogResim" position="top" maximizable="true" modal="true"
              appendTo="@(body)" closeOnEscape="true"
              onShow="PF('dialogResim').initPosition();PF('rotateAndResizeWidget').scale(1.25);return false;"
              responsive="true"
              style="overflow: auto;width: 500px">
        <h:form id="formResim" styleClass="w-100">
            <p:commandButton id="zoomin" icon="ui-icon-zoomin" value="Büyüt +" style="float: left"
                             onclick="PF('rotateAndResizeWidget').scale(1.25);return false;"/>
            <p:commandButton icon="ui-icon-zoomout" value="Küçült -" style="float: left"
                             onclick="PF('rotateAndResizeWidget').scale(0.75);return false;"/>

            <p:graphicImage id="images" value="#{imageController.preview}" style="height: 500px !important; width: 500px !important"
                            cache="false"/>

            <pe:imageRotateAndResize id="rotateAndResize" for="images" widgetVar="rotateAndResizeWidget">
            </pe:imageRotateAndResize>

        </h:form>

    </p:dialog>


</ui:composition>
</html>
